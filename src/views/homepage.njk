{% extends "govuk/template.njk" %}

{% from "govuk/components/button/macro.njk" import govukButton %}
{% from "govuk/components/header/macro.njk" import govukHeader %}
{% from "govuk/components/input/macro.njk" import govukInput %}
{% from "govuk/components/phase-banner/macro.njk" import govukPhaseBanner %}
{% from "govuk/components/service-navigation/macro.njk" import govukServiceNavigation %}
{% from "govuk/components/summary-list/macro.njk" import govukSummaryList %}

{% block pageTitle %}GOV.UK components test{% endblock %}

{% block head %}
    <link rel="stylesheet" href="/govuk/govuk-frontend.min.css">
{% endblock %}

{% block header %}
    {{ govukHeader({
        serviceName: "The Kainos Library",
        serviceUrl: "/"
    }) }}
{% endblock %}

{% block beforeContent %}
    {{ govukPhaseBanner({
        tag: { text: "Beta" },
        html: 'This is a prototype library website.'
    }) }}
{% endblock %}

{% block content %}

{{ govukServiceNavigation({
  navigation: [
    {
      href: "#",
      text: "Members",
      active: true
    },
    {
      href: "#",
      text: "Books"
    },
    {
      href: "#",
      text: "Borrow Info "
    }
  ]
}) }}

<div class="govuk-width-container">
  <main class="govuk-main-wrapper" id="main-content" role="main">
    <div class="govuk-grid-row">
      <div class="govuk-grid-column-one-third">
        <h2 class="govuk-heading-m">Search books</h2>
        <form method="get" action="/" class="govuk-!-margin-bottom-6">
          {{ govukInput({
            label: {
              text: "Title or author"
            },
            id: "q",
            name: "q"
          }) }}
          {{ govukButton({
            text: "Search"
          }) }}
        </form>
      </div>
      <div class="govuk-grid-column-two-thirds">
        <h2 class="govuk-heading-m">Books</h2>

        {% if apiError %}
          <div class="govuk-inset-text">We could not load books: {{ apiError }}</div>
        {% endif %}

        {% if books and books | length %}
          {% for book in books %}
            <h3 class="govuk-heading-s">{{ book.title }}</h3>
            <p class="govuk-body">{{ book.description }}</p>
            {{ govukSummaryList({
              rows: [
                {
                  key: {
                    text: "Author"
                  },
                  value: {
                    text: book.authors | join(", ")
                  }
                },
                {
                  key: {
                    text: "Genre"
                  },
                  value: {
                    text: book.genre
                  }
                },
                {
                  key: {
                    text: "ISBN"
                  },
                  value: {
                    text: book.isbn
                  }
                },
                {
                  key: {
                    text: "Publication year"
                  },
                  value: {
                    text: book.publication_year
                  }
                },
                {
                  key: {
                    text: "Total copies"
                  },
                  value: {
                    text: book.total_copies
                  }
                },
                {
                  key: {
                    text: "Available copies"
                  },
                  value: {
                    text: book.available_copies
                  }
                }
              ]
            }) }}
            <hr class="govuk-section-break govuk-section-break--l govuk-section-break--visible">
          {% endfor %}
        {% else %}
          <p class="govuk-body">No books to display.</p>
        {% endif %}
      </div>
    </div>
  </main>
</div>
{% endblock %}

{% block bodyEnd %}
    <script src="/govuk/govuk-frontend.min.js"></script>
    <script>
        window.GOVUKFrontend.initAll();
    </script>
{% endblock %}